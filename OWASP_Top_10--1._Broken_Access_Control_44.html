<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>1. Broken Access Control</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>1. Broken Access Control</h1><br/><p><ul><li>Access Control:<ul><li>enforces policy such that users cannoy act outside of their intended permissions.</li><li>Failure leads <ul><li>to unauthorized disclosure</li><li>modification, </li><li>destruction of data, </li><li>performing a business function outside the user&#39;s limit</li></ul></li></ul></li></ul></p><p><ul><li>Common vulnerabilities include:<ul><li>Violation of the principle of least privilege or deny by default, where access should only be granted for particular capabilities, roles, or users, but is available to anyone.</li><li>Bypassing access control checks by modifying the URL (parameter tampering or force browsing), internal application state, or the HTML page, or by using an attack tool modifying API requests.</li><li>Permitting viewing or editing someone else&#39;s account, by providing its unique identifier (insecure direct object references)</li><li>Accessing API with missing access controls for POST, PUT and DELETE.</li><li>Elevation of privilege. Acting as a user without being logged in or acting as an admin when logged in as a user.</li><li>Metadata manipulation, such as replaying or tampering with a JSON Web Token (JWT) access control token, or a cookie or hidden field manipulated to elevate privileges or abusing JWT invalidation.</li><li>CORS misconfiguration allows API access from unauthorized/untrusted origins.</li><li>Force browsing to authenticated pages as an unauthenticated user or to privileged pages as a standard user.</li></ul></li></ul></p><p><ul><li>How to prevent:<ul><li>Except for public resources, deny by default.</li><li>Implement access control mechanisms once and re-use them throughout the application, including minimizing Cross-Origin Resource Sharing (CORS) usage.</li><li>Model access controls should enforce record ownership rather than accepting that the user can create, read, update, or delete any record.</li><li>Unique application business limit requirements should be enforced by domain models.</li><li>Disable web server directory listing and ensure file metadata (e.g., .git) and backup files are not present within web roots.</li><li>Log access control failures, alert admins when appropriate (e.g., repeated failures).</li><li>Rate limit API and controller access to minimize the harm from automated attack tooling.</li><li>Stateful session identifiers should be invalidated on the server after logout. Stateless JWT tokens should rather be short-lived so that the window of opportunity for an attacker is minimized. For longer lived JWTs it&#39;s highly recommended to follow the OAuth standards to revoke access.</li></ul></li></ul></p><p><ul><li>Example Attack Scenarios<ul><li>1. Privilege escalation: An attacker gains access to a low-privileged account and then exploits vulnerabilities in the system to elevate their privileges and gain access to sensitive data or resources.</li><li>2. Horizontal privilege escalation: An attacker gains access to another user&#39;s account with the same level of privileges, allowing them to perform actions they are not authorized to do.</li><li>3. Vertical privilege escalation: An attacker gains access to an account with higher privileges than their own, allowing them to perform actions they are not authorized to do.</li><li>4. Directory traversal attacks: An attacker manipulates input parameters in web applications that use directory paths without proper validation, allowing them to access files outside of the intended directory.</li><li>5. Broken authentication and session management: Attackers exploit weaknesses in authentication and session management mechanisms, such as weak passwords or session IDs that can be easily guessed or stolen.</li><li>6. Insufficient authorization checks: Attackers exploit vulnerabilities in authorization checks that allow them to bypass security controls and gain unauthorized access to resources or data.</li><li>7. Accessing restricted URLs: Attackers try accessing restricted URLs directly by guessing the URL pattern or using brute force techniques.</li></ul></li></ul></p><p></p><p></p></div>
</body>
</html>
